'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _ = require('..');

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _chaiAsPromised = require('chai-as-promised');

var _chaiAsPromised2 = _interopRequireDefault(_chaiAsPromised);

var _bluebird = require('bluebird');

var _bluebird2 = _interopRequireDefault(_bluebird);

var _sinon = require('sinon');

var _sinon2 = _interopRequireDefault(_sinon);

var should = _chai2['default'].should();
_chai2['default'].use(_chaiAsPromised2['default']);

describe('util', function () {
  describe('hasValue', function () {
    it('should exist', function () {
      should.exist(_.util.hasValue);
    });

    it('should handle undefined', function () {
      _.util.hasValue(undefined).should.be['false'];
    });

    it('should handle not a number', function () {
      _.util.hasValue(NaN).should.be['false'];
    });

    it('should handle null', function () {
      _.util.hasValue(null).should.be['false'];
    });

    it('should handle functions', function () {
      _.util.hasValue(function () {}).should.be['true'];
    });

    it('should handle empty arrays', function () {
      _.util.hasValue({}).should.be['true'];
    });

    it('should handle zero', function () {
      _.util.hasValue(0).should.be['true'];
    });

    it('should handle simple string', function () {
      _.util.hasValue('string').should.be['true'];
    });

    it('should handle booleans', function () {
      _.util.hasValue(false).should.be['true'];
    });

    it('should handle empty strings', function () {
      _.util.hasValue('').should.be['true'];
    });
  });

  describe('hasContent', function () {
    it('should exist', function () {
      should.exist(_.util.hasContent);
    });

    it('should handle undefined', function () {
      _.util.hasContent(undefined).should.be['false'];
    });

    it('should handle not a number', function () {
      _.util.hasContent(NaN).should.be['false'];
    });

    it('should handle null', function () {
      _.util.hasContent(null).should.be['false'];
    });

    it('should handle functions', function () {
      _.util.hasContent(function () {}).should.be['false'];
    });

    it('should handle empty arrays', function () {
      _.util.hasContent({}).should.be['false'];
    });

    it('should handle zero', function () {
      _.util.hasContent(0).should.be['false'];
    });

    it('should handle simple string', function () {
      _.util.hasContent('string').should.be['true'];
    });

    it('should handle booleans', function () {
      _.util.hasContent(false).should.be['false'];
    });

    it('should handle empty strings', function () {
      _.util.hasContent('').should.be['false'];
    });
  });

  describe('escapeSpace', function () {
    it('should do nothing to a string without space', function () {
      var actual = 'appium';
      var expected = 'appium';
      _.util.escapeSpace(actual).should.equal(expected);
    });

    it('should do escape spaces', function () {
      var actual = '/Applications/ Xcode 6.1.1.app/Contents/Developer';
      var expected = '/Applications/\\ Xcode\\ 6.1.1.app/Contents/Developer';
      _.util.escapeSpace(actual).should.equal(expected);
    });

    it('should escape consecutive spaces', function () {
      var actual = 'appium   space';
      var expected = 'appium\\ \\ \\ space';
      _.util.escapeSpace(actual).should.equal(expected);
    });
  });

  describe('localIp', function () {
    it('should find a local ip address', function () {
      var utilMock = _sinon2['default'].mock(_.util);
      utilMock.expects('localIp').returns('10.35.4.175');
      _.util.localIp();
      utilMock.verify();
    });
  });

  describe('cancellableDelay', function () {
    it('should delay', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(_.util.cancellableDelay('10'));

          case 2:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('cancel should work', function callee$2$0() {
      var delay;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            delay = _.util.cancellableDelay('1000');

            _bluebird2['default'].delay(10).then(function () {
              delay.cancel();
            }).done();
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(delay.should.be.rejectedWith(/cancellation error/));

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });

  describe('safeJsonParse', function () {
    it('should pass object through', function () {
      var obj = { a: 'a', b: 'b' };
      _.util.safeJsonParse(obj).should.equal(obj);
    });
    it('should correctly parse json string', function () {
      var obj = { a: 'a', b: 'b' };
      _.util.safeJsonParse(JSON.stringify(obj)).should.eql(obj);
    });
    it('should pass a number through', function () {
      var num = 42;
      _.util.safeJsonParse(num).should.eql(num);
    });
    it('should make a number from a string representation', function () {
      var num = 42;
      _.util.safeJsonParse(String(num)).should.eql(num);
    });
  });
});
//# sourceMappingURL=data:application/json;base64,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QUFHLENBQUMsR0FBRyxDQUFDLENBQUM7S0FDakQsQ0FBQyxDQUFDO0dBQ0osQ0FBQyxDQUFDO0NBQ0osQ0FBQyxDQUFDIiwiZmlsZSI6InRlc3QvdXRpbC1zcGVjcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHsgdXRpbCB9IGZyb20gJy4uJztcbmltcG9ydCBjaGFpIGZyb20gJ2NoYWknO1xuaW1wb3J0IGNoYWlBc1Byb21pc2VkIGZyb20gJ2NoYWktYXMtcHJvbWlzZWQnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IHNpbm9uIGZyb20gJ3Npbm9uJztcblxubGV0IHNob3VsZCA9IGNoYWkuc2hvdWxkKCk7XG5jaGFpLnVzZShjaGFpQXNQcm9taXNlZCk7XG5cbmRlc2NyaWJlKCd1dGlsJywgZnVuY3Rpb24gKCkge1xuICBkZXNjcmliZSgnaGFzVmFsdWUnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCBleGlzdCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHNob3VsZC5leGlzdCh1dGlsLmhhc1ZhbHVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHVuZGVmaW5lZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHV0aWwuaGFzVmFsdWUodW5kZWZpbmVkKS5zaG91bGQuYmUuZmFsc2U7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBub3QgYSBudW1iZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICB1dGlsLmhhc1ZhbHVlKE5hTikuc2hvdWxkLmJlLmZhbHNlO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbnVsbCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHV0aWwuaGFzVmFsdWUobnVsbCkuc2hvdWxkLmJlLmZhbHNlO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZnVuY3Rpb25zJywgZnVuY3Rpb24gKCkge1xuICAgICAgdXRpbC5oYXNWYWx1ZShmdW5jdGlvbiAoKSB7fSkuc2hvdWxkLmJlLnRydWU7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBhcnJheXMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB1dGlsLmhhc1ZhbHVlKHt9KS5zaG91bGQuYmUudHJ1ZTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHplcm8nLCBmdW5jdGlvbiAoKSB7XG4gICAgICB1dGlsLmhhc1ZhbHVlKDApLnNob3VsZC5iZS50cnVlO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2ltcGxlIHN0cmluZycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHV0aWwuaGFzVmFsdWUoJ3N0cmluZycpLnNob3VsZC5iZS50cnVlO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYm9vbGVhbnMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB1dGlsLmhhc1ZhbHVlKGZhbHNlKS5zaG91bGQuYmUudHJ1ZTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHN0cmluZ3MnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB1dGlsLmhhc1ZhbHVlKCcnKS5zaG91bGQuYmUudHJ1ZTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2hhc0NvbnRlbnQnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCBleGlzdCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHNob3VsZC5leGlzdCh1dGlsLmhhc0NvbnRlbnQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdW5kZWZpbmVkJywgZnVuY3Rpb24gKCkge1xuICAgICAgdXRpbC5oYXNDb250ZW50KHVuZGVmaW5lZCkuc2hvdWxkLmJlLmZhbHNlO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbm90IGEgbnVtYmVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgdXRpbC5oYXNDb250ZW50KE5hTikuc2hvdWxkLmJlLmZhbHNlO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbnVsbCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHV0aWwuaGFzQ29udGVudChudWxsKS5zaG91bGQuYmUuZmFsc2U7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBmdW5jdGlvbnMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB1dGlsLmhhc0NvbnRlbnQoZnVuY3Rpb24gKCkge30pLnNob3VsZC5iZS5mYWxzZTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IGFycmF5cycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHV0aWwuaGFzQ29udGVudCh7fSkuc2hvdWxkLmJlLmZhbHNlO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgemVybycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHV0aWwuaGFzQ29udGVudCgwKS5zaG91bGQuYmUuZmFsc2U7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzaW1wbGUgc3RyaW5nJywgZnVuY3Rpb24gKCkge1xuICAgICAgdXRpbC5oYXNDb250ZW50KCdzdHJpbmcnKS5zaG91bGQuYmUudHJ1ZTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGJvb2xlYW5zJywgZnVuY3Rpb24gKCkge1xuICAgICAgdXRpbC5oYXNDb250ZW50KGZhbHNlKS5zaG91bGQuYmUuZmFsc2U7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBzdHJpbmdzJywgZnVuY3Rpb24gKCkge1xuICAgICAgdXRpbC5oYXNDb250ZW50KCcnKS5zaG91bGQuYmUuZmFsc2U7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdlc2NhcGVTcGFjZScsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIGRvIG5vdGhpbmcgdG8gYSBzdHJpbmcgd2l0aG91dCBzcGFjZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBhY3R1YWwgPSAnYXBwaXVtJztcbiAgICAgIGxldCBleHBlY3RlZCA9ICdhcHBpdW0nO1xuICAgICAgdXRpbC5lc2NhcGVTcGFjZShhY3R1YWwpLnNob3VsZC5lcXVhbChleHBlY3RlZCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRvIGVzY2FwZSBzcGFjZXMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgYWN0dWFsID0gJy9BcHBsaWNhdGlvbnMvIFhjb2RlIDYuMS4xLmFwcC9Db250ZW50cy9EZXZlbG9wZXInO1xuICAgICAgbGV0IGV4cGVjdGVkID0gJy9BcHBsaWNhdGlvbnMvXFxcXCBYY29kZVxcXFwgNi4xLjEuYXBwL0NvbnRlbnRzL0RldmVsb3Blcic7XG4gICAgICB1dGlsLmVzY2FwZVNwYWNlKGFjdHVhbCkuc2hvdWxkLmVxdWFsKGV4cGVjdGVkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZXNjYXBlIGNvbnNlY3V0aXZlIHNwYWNlcycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBhY3R1YWwgPSAnYXBwaXVtICAgc3BhY2UnO1xuICAgICAgbGV0IGV4cGVjdGVkID0gJ2FwcGl1bVxcXFwgXFxcXCBcXFxcIHNwYWNlJztcbiAgICAgIHV0aWwuZXNjYXBlU3BhY2UoYWN0dWFsKS5zaG91bGQuZXF1YWwoZXhwZWN0ZWQpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnbG9jYWxJcCcsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIGZpbmQgYSBsb2NhbCBpcCBhZGRyZXNzJywgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHV0aWxNb2NrID0gc2lub24ubW9jayh1dGlsKTtcbiAgICAgIHV0aWxNb2NrLmV4cGVjdHMoJ2xvY2FsSXAnKS5yZXR1cm5zKCcxMC4zNS40LjE3NScpO1xuICAgICAgdXRpbC5sb2NhbElwKCk7XG4gICAgICB1dGlsTW9jay52ZXJpZnkoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NhbmNlbGxhYmxlRGVsYXknLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCBkZWxheScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGF3YWl0IHV0aWwuY2FuY2VsbGFibGVEZWxheSgnMTAnKTtcbiAgICB9KTtcbiAgICBpdCgnY2FuY2VsIHNob3VsZCB3b3JrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGRlbGF5ID0gdXRpbC5jYW5jZWxsYWJsZURlbGF5KCcxMDAwJyk7XG4gICAgICBCLmRlbGF5KDEwKS50aGVuKGZ1bmN0aW9uKCkgeyBkZWxheS5jYW5jZWwoKTsgfSkuZG9uZSgpO1xuICAgICAgYXdhaXQgZGVsYXkuc2hvdWxkLmJlLnJlamVjdGVkV2l0aCgvY2FuY2VsbGF0aW9uIGVycm9yLyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzYWZlSnNvblBhcnNlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcGFzcyBvYmplY3QgdGhyb3VnaCcsICgpID0+IHtcbiAgICAgIGxldCBvYmogPSB7YTogJ2EnLCBiOiAnYid9O1xuICAgICAgdXRpbC5zYWZlSnNvblBhcnNlKG9iaikuc2hvdWxkLmVxdWFsKG9iaik7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBjb3JyZWN0bHkgcGFyc2UganNvbiBzdHJpbmcnLCAoKSA9PiB7XG4gICAgICBsZXQgb2JqID0ge2E6ICdhJywgYjogJ2InfTtcbiAgICAgIHV0aWwuc2FmZUpzb25QYXJzZShKU09OLnN0cmluZ2lmeShvYmopKS5zaG91bGQuZXFsKG9iaik7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBwYXNzIGEgbnVtYmVyIHRocm91Z2gnLCAoKSA9PiB7XG4gICAgICBsZXQgbnVtID0gNDI7XG4gICAgICB1dGlsLnNhZmVKc29uUGFyc2UobnVtKS5zaG91bGQuZXFsKG51bSk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBtYWtlIGEgbnVtYmVyIGZyb20gYSBzdHJpbmcgcmVwcmVzZW50YXRpb24nLCAoKSA9PiB7XG4gICAgICBsZXQgbnVtID0gNDI7XG4gICAgICB1dGlsLnNhZmVKc29uUGFyc2UoU3RyaW5nKG51bSkpLnNob3VsZC5lcWwobnVtKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdfQ==